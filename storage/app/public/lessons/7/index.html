<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тема 7</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="text">
       <div>Часто информация хранится в неструктурированном виде, т. е. не имеет заранее определенной структуры данных, либо не организована в установленном порядке. Такие данные, как правило, представлены в форме текста или больших неупорядоченных таблиц. Это приводит к трудностям анализа, особенно в случае использования традиционных программ, предназначенных для работы со структурированными данными.</div>

		<div>&nbsp;</div>

		<div>Помимо ручного добавления данных в базу может возникнуть необходимость обработки данных и импорта. Для импорта могут быть представлены файлы и данные в разном формате. Например, сейчас у нас есть:</div>

		<div>&nbsp;</div>
		
		<div>Список менеджеров в формате csv</div>

		<div><img alt="" src="img/1.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>Список автомобилей в формате xlsx</div>

		<div><img alt="" src="img/2.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>Список фотографий автомобилей в виде изображений</div>

		<div><img alt="" src="img/3.jpg" /></div>

		<div>&nbsp;</div>

		<div>В этом уроке мы протестируем несколько разных способов импорта данных, предварительно очистив&nbsp;базу данных.</div>

		<div>&nbsp;</div>

		<h1>Работа с текстовыми данными</h1>

		<div><strong>Импорт списка менеджеров</strong></div>

		<div>Переходим к списку менеджеров и воспользуемся мастером импорта и экспорта.</div>

		<div>&nbsp;</div>

		<div>1. Кликаем по названию базы данных Задачи &mdash; Импорт данных</div>

		<div><img alt="" src="img/4.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>2. В качестве источника данных выбираем неструктурированный файл</div>

		<div><img alt="" src="img/5.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>3. Тип:&nbsp;CSV-файлы</div>

		<div><img alt="" src="img/6.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>4. На вкладке &quot;Предварительный просмотр&quot;&nbsp;мы можем увидеть, как они будут представлены</div>

		<div><img alt="" src="img/7.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>5. Убираем галочку на параметре &quot;Имена столбцов в первой строке даных&quot;, указывающем, что первая строка &mdash; это заголовок</div>

		<div><img alt="" src="img/8.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>6. Далее выбираем, куда мы хотим импортировать данные &mdash; нашу базу</div>

		<div><img alt="" src="img/9.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>7. После чего выбираем таблицу, где данные будут размещены</div>

		<div><img alt="" src="img/10.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>8. Далее &mdash; Далее &mdash; Финиш. 5 строк&nbsp;было импортировано. Можем их увидеть в таблице</div>

		<div><img alt="" src="img/11.jpg" /></div>
		
		<div>&nbsp;</div>

		<div><strong>Импорт списка автомобилей</strong></div>

		<div>&nbsp;</div>

		<div>1. Приступаем к импорту автомобилей</div>

		<div><img alt="" src="img/12.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>2. В таблицах могут встречаться дубликаты, поэтому желательно проверять этот момент и удалять их. Выделяем все данные &mdash; Данные &mdash; Удалить дубликаты. Но в нашем случае их нет.</div>

		<div><img alt="" src="img/13.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>3. Изменяем порядок столбцов таким образом, чтобы они соответствовали порядку в таблице базы данных.​</div>

		<div><img alt="" src="img/14.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>4. Вставляем в таблицу Cars</div>

		<div><img alt="" src="img/15.jpg" /></div>
		
		<div>&nbsp;</div>

		<div><strong>Импорт таблицы Cars через Visual Studio</strong></div>

		<div>Так как структура данных сложная: список полей, папки с картинками, которые также должны храниться в базе данных, предлагаем выполнить импорт с помощью кода С# в Visual Studio</div>

		<div>&nbsp;</div>

		<div>1. Воспользуемся существующим проектом, и в MainWindow&nbsp;создаем метод для импорта автомобилей. Можем сразу вызвать его при запуске</div>

		<div><img alt="" src="img/16.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>2. Прежде чем работать в коде с файлом автомобилей, сохраняем его как &quot;Текст Юникод&quot;&nbsp;и удаляем в итоговом файле первую строку с заголовком. Файл &mdash; Сохранить как &mdash; &quot;Текст Юникод&quot;.</div>

		<div><img alt="" src="img/17.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>3. Удаляем строку с заголовками</div>

		<div><img alt="" src="img/18.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>4. Создаем две переменные</div>

		<div><img alt="" src="img/19.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>5. Пробежимся по строкам в файле, разделив данные с помощью табов, и создаем экземпляр класса, заполнив свойства соответствующими значениями, и не забывая про типы данных</div>

		<div><img alt="" src="img/20.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>6. Записываем изображения&nbsp;в базу данных с помощью метода ReadAllBytes()</div>

		<div><img alt="" src="img/21.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>7. Если вы забыли добавить поле для картинки, то необходимо сначала добавить его в базе данных, а затем пересоздать ADO.NET модель</div>

		<div><img alt="" src="img/22.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>8 Добавляем тур в базу и сохраняем</div>

		<div><img alt="" src="img/23.jpg" /></div>
		
		<div>&nbsp;</div>

		<div>9. Вызываем метод в конструкторе MainWindow и проверяем результат в базе данных. Список автомобилей с картинками импортирован.</div>

		<div><img alt="" src="img/24.jpg" /></div>

		<h1>Итоги</h1>

		<div>Мы рассмотрели некоторые полезные функции для обработки неструктурированных данных, а также различные способы импорта в базу данных.</div>

    </div>
</body>
</html>