<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тема 20</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="text">
		<h1><strong>Демонстрация работы с&nbsp;графиками в&nbsp;Windows Forms</strong></h1>

		<p>На&nbsp;данном занятии будет разработано простое приложение Windows Forms для визуализации расходов пользователей. Пользователи распределяют затраты по&nbsp;разным категориям и&nbsp;хранят их&nbsp;в&nbsp;общей базе данных. Итогом работы приложения будет служить работающая форма, в&nbsp;которой для каждого пользователя можно построить диаграммы различных типов для визуализации их&nbsp;расходов по&nbsp;категориям. Основные шаги построения приложения:</p>

		<ol>
			<li>Разработка интерфейса приложения</li>
			<li>Настройка взаимодействия с&nbsp;базой данных</li>
			<li>Реализация обработки данных</li>
		</ol>

		<p><strong>Важно</strong></p>

		<p>В&nbsp;рамках примера используется готовая база данных с&nbsp;информацией о&nbsp;пользователях, их&nbsp;платежах и&nbsp;категориях расходов <a href="PaymentsBase.bak">(Скачать)</a></p>

		<h1><strong>Разработка интерфейса приложения</strong></h1>

		<p><strong>1.</strong>&nbsp;Устанавливаем структуру формы</p>

		<p><img alt="" src="img/1.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Интерфейс приложения будет состоять из&nbsp;двух основных частей: области построения и&nbsp;области настройки параметров просмотра</p>

		<p><strong>2.</strong>&nbsp;Добавляем элементы настройки параметров просмотра</p>

		<p><img alt="" src="img/2.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Элементами настройки параметров просмотра будут являться выпадающие списки, позволяющие выбрать пользователя и&nbsp;тип диаграммы</p>

		<p><strong>3.</strong>&nbsp;Подключаем библиотеки для просмотра диаграмм</p>

		<p><img alt="" src="img/3.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Диаграмма будет визуализироваться с&nbsp;помощью элемента Chart из&nbsp;WindowsForms. Воспользоваться данным элементом можно после подключения библиотеки System.Windows.Forms.DataVisualization, расположенного во&nbsp;вкладке Assemblies (сборки)</p>

		<p><strong>4.</strong>&nbsp;Добавляем элементы управления диаграммой</p>

		<p><img alt="" src="img/4.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Диаграмма будет располагаться внутри элемента WindowsFormsHost. Данный элемент добавляется из&nbsp;окна ToolBox простым перетаскиванием</p>

		<p><strong>5.</strong>&nbsp;Добавляем пространство имен для работы с&nbsp;элементом Chart</p>

		<p><img alt="" src="img/5.jpg" /></p>

		<p><strong>6.</strong>&nbsp;Добавляем дополнительные параметры просмотра</p>

		<p><img alt="" src="img/6.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Дополнительными параметрами являются имя диаграммы, а&nbsp;также легенда</p>

		<h1><strong>Настройка взаимодействия с базой данных</strong></h1>

		<p><strong>1.</strong>&nbsp;Реализуем взаимодействие с&nbsp;базой данных</p>

		<p><img alt="" src="img/7.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Взаимодействие реализуется путем добавления элемента &laquo;ADO.NET Entity Data Model&raquo;</p>

		<p><strong>2.</strong>&nbsp;Настраиваем свойства подключения базы данных</p>

		<p><img alt="" src="img/8.jpg" /></p>

		<p><strong>3.</strong>&nbsp;Добавляем подключение к&nbsp;базе данных</p>

		<p><img alt="" src="img/9.jpg" /></p>

		<h1><strong>Реализация обработки данных</strong></h1>

		<p><strong>1.</strong>&nbsp;Создаем область построения графиков</p>

		<p><img alt="" src="img/10.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Сперва создается поле для контекста EntityFramework с&nbsp;инициализацией. Затем создается область построения диаграммы ChartArea и&nbsp;добавляется в&nbsp;соответствующую коллекцию в&nbsp;конструкторе MainWindow</p>

		<p><strong>2.</strong>&nbsp;Добавляем наборы данных</p>

		<p><img alt="" src="img/11.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Для каждого набора данных (например, данные линии на&nbsp;графике) необходимо добавлять в&nbsp;коллекцию Series. В&nbsp;данном случае есть одна серия данных для отображения сумм платежей по&nbsp;категориям. Объект Series создается с&nbsp;указанием названия и&nbsp;необходимости отображения на&nbsp;диаграмме</p>

		<p><strong>3.</strong>&nbsp;Загружаем данные из&nbsp;базы</p>

		<p><img alt="" src="img/12.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Данные о&nbsp;пользователях загружаются в&nbsp;выпадающий список. Также загружаются типы диаграммы из&nbsp;перечисления SeriesChartType</p>

		<p><strong>4.</strong>&nbsp;Реализуем адаптивное изменение интерфейса</p>

		<p><img alt="" src="img/13.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>При выборе другого значения в ComboBox будет вызываться метод UpdateChart()</p>

		<p><strong>5.</strong>&nbsp;Получаем выбранные значения в&nbsp;выпадающих списках</p>

		<p><img alt="" src="img/14.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Значения получаются как currentUser и&nbsp;currentType</p>

		<p><strong>6.</strong>&nbsp;Обрабатываем данные диаграммы</p>

		<p><img alt="" src="img/15.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Приведенный код описывает получение серии данных диаграммы из&nbsp;соответствующей коллекции Series, установку типа диаграммы и&nbsp;очистку предыдущих данных</p>

		<p><strong>7.</strong>&nbsp;Обрабатываем список категорий</p>

		<p><img alt="" src="img/16.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Список категорий получается из&nbsp;базы данных. Далее, в&nbsp;цикле foreach для каждой категории значение точки диаграммы добавляется в&nbsp;Points. Координата X&nbsp;будет названием категории, а&nbsp;координата Y&nbsp;будет суммой платежа для выбранного пользователя в&nbsp;текущей категории</p>

		<h1><strong>Результат работы программы</strong></h1>

		<p><img alt="" src="img/17.jpg" /></p>

		<h1>Итоги</h1>

		<p>Вы&nbsp;познакомились с&nbsp;тем, как использовать основные элементы Windows Forms в&nbsp;приложении WPF</p>

    </div>
</body>
</html>