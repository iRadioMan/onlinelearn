<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тема 22</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="text">
		<h1><strong>Демонстрация работы с&nbsp;документами Word в&nbsp;WPF</strong></h1>

		<p>На&nbsp;данном занятии будет реализована возможность экспорта данных из&nbsp;приложения для визуализации расходов пользователей в&nbsp;документ Word. Расходы каждого пользователя будут экспортироваться на&nbsp;отдельную страницу, названием которой будет ФИО пользователя. Расходы будут просуммированы по&nbsp;категориям и&nbsp;представлены в&nbsp;виде таблицы. Под таблицей будет размещена информация о&nbsp;максимальном и&nbsp;минимальном платежах данного пользователя. Основные шаги построения приложения:</p>

		<ol>
			<li>Подготовительный этап</li>
			<li>Реализация экспорта в&nbsp;документ Word</li>
			<li>Завершение оформления документа Word</li>
		</ol>

		<h1><strong>Подготовительный этап</strong></h1>

		<p><strong>1.</strong>&nbsp;Подключаем библиотеку для работы с&nbsp;Word</p>

		<p><img alt="" src="img/1.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Для экспорта данных в&nbsp;Word используется библиотека InteropWord (Object Library), расположенная во&nbsp;вкладке COM</p>

		<p><strong>2.</strong>&nbsp;Добавляем кнопку экспорта</p>

		<p><img alt="" src="img/2.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Экспорт данных в&nbsp;Word будет осуществляться с&nbsp;помощью кнопки &laquo;Экспорт в&nbsp;Word&raquo;</p>

		<p><strong>3.</strong>&nbsp;Подключаем пространство имен для работы с Word</p>

		<p><img alt="" src="img/3.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Требуемое пространство имен подключается с&nbsp;помощью директивы using</p>

		<h1><strong>Реализация экспорта в документ Word</strong></h1>

		<p><strong>1.</strong>&nbsp;Получаем список пользователей и&nbsp;категорий</p>

		<p><img alt="" src="img/4.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Список пользователей и&nbsp;категорий выгружается из&nbsp;базы данных</p>

		<p><strong>2.</strong>&nbsp;Создаем новый документ Word</p>

		<p><img alt="" src="img/5.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>После создания экземпляра Word в&nbsp;приложение добавляется новый документ, с&nbsp;которым далее происходит работа</p>

		<p><strong>3.</strong>&nbsp;Создаем параграф для хранения названий страниц</p>

		<p><img alt="" src="img/6.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Основной структурной единицей текста является параграф, представленный объектом Paragraph. Все абзацы объединяются в&nbsp;коллекцию Paragraphs, причем новые параграфы добавляются с&nbsp;помощью метода Add. Доступ к&nbsp;тексту предоставляет объект Range, являющийся свойством Paragraph, а&nbsp;текстовое содержание абзаца доступно через Range.Text. В&nbsp;данном случае для хранения ФИО каждого пользователя создается новый параграф</p>

		<p><strong>4.</strong>&nbsp;Добавляем названия страниц</p>

		<p><img alt="" src="img/7.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>В&nbsp;качестве названия выбирается имя пользователя, к&nbsp;которому применяется стиль &laquo;Title&raquo;, после чего добавляется новый параграф для таблицы с&nbsp;платежами</p>

		<p><strong>5.</strong>&nbsp;Добавляем и&nbsp;форматируем таблицу для хранения информации о&nbsp;платежах</p>

		<p><img alt="" src="img/8.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>После создания параграфа для таблицы и&nbsp;получения его Range, добавляется таблица с&nbsp;указанием числа строк (по&nbsp;количеству категорий&nbsp;+&nbsp;1) и&nbsp;столбцов. Последние две строчки касаются указания границ (внутренних и&nbsp;внешних) и&nbsp;выравнивания ячеек (по&nbsp;центру и&nbsp;по&nbsp;вертикали)</p>

		<p><strong>6.</strong>&nbsp;Добавляем названия колонок и&nbsp;их&nbsp;форматирование</p>

		<p><img alt="" src="img/9.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Таблица состоит из&nbsp;трех колонок с&nbsp;названиями &laquo;Иконка&raquo;, &laquo;Категория&raquo; и&nbsp;&laquo;Сумма расходов&raquo;. Названия колонок выделяются жирным шрифтом и&nbsp;выравниваются по&nbsp;центру</p>

		<p><strong>7.</strong>&nbsp;Заполняем первую колонку таблицы</p>

		<p><img alt="" src="img/10.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Положение ячейки заносится в&nbsp;переменную cellRange. Метод AddPicture() класса InlineShape позволяет добавить изображение в&nbsp;ячейку. Иконки категорий размещаются в корне проекта</p>

		<p><strong>8.</strong>&nbsp;Форматируем первую колонку таблицы</p>

		<p><img alt="" src="img/11.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Для первой колонки устанавливаются длина, ширина, а&nbsp;также горизонтальное выравнивание по&nbsp;центру</p>

		<p><strong>9.&nbsp;</strong>Заполняем вторую и&nbsp;третью колонки</p>

		<p><img alt="" src="img/12.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>Сумма платежей приводится к&nbsp;нужному формату с&nbsp;указанием единиц измерения (руб.) непосредственно в&nbsp;коде</p>

		<h1><strong>Завершение оформления документа Word</strong></h1>

		<p><strong>3.&nbsp;</strong>Делаем заключительные шаги</p>

		<p><img alt="" src="img/13.jpg" /></p>
		
		<p><img alt="" src="img/14.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>По&nbsp;завершении работы с&nbsp;данными пользователя добавляется разрыв страницы. Далее, разрешается отображение таблицы по&nbsp;завершении экспорта. Наконец, документ сохраняется в&nbsp;формате .docx и .pdf</p>

		<p><strong>4.&nbsp;</strong>Проверяем результат</p>

		<p><img alt="" src="img/15.jpg" /></p>

		<h1>Итоги</h1>

		<p>Вы&nbsp;познакомились с&nbsp;основными программными методами работы с&nbsp;документами Word в&nbsp;WPF.&nbsp;</p>

    </div>
</body>
</html>