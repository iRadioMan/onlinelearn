<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тема 11</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="text">
		<p>Продолжим тему мобильной разработки и&nbsp;поговорим о&nbsp;кроссплатформенной разработке на&nbsp;Xamarin.Forms. Эта платформа позволяет создавать одну единственную логику приложения с&nbsp;применением C# сразу для всех трех платформ: Android, iOS и&nbsp;UWP. Из&nbsp;преимуществ можно назвать: единый код для всех платформ, прямой доступ к&nbsp;нативным API каждой платформы, возможность использования платформы .net и&nbsp;языка программирования С#, который является достаточно производительным, и&nbsp;в&nbsp;то&nbsp;же время простым для освоения и&nbsp;понимания.</p>

		<p><strong>1.</strong>&nbsp;Для начала создаем проект в&nbsp;Xamarin.Forms</p>

		<p><img alt="" src="img/1.jpg" /></p>

		<ul>
			<li>Даем ему название</li>
		</ul>

		<p><img alt="" src="img/2.jpg" /></p>

		<ul>
			<li>В&nbsp;Xamarin представлен ряд шаблонов. Можно использовать списки, вкладки&hellip; Пока что мы&nbsp;будем просто выбирать Blank&nbsp;&mdash; пустую страницу, и&nbsp;убираем платформу iOS&nbsp;&mdash; нам сейчас нужен только Android</li>
		</ul>

		<p><img alt="" src="img/3.jpg" /></p>

		<ul>
			<li>В&nbsp;файле App.xaml.cs прописываем главную страницу для навигации</li>
		</ul>

		<p><img alt="" src="img/4.jpg" /></p>

		<ul>
			<li>Ставим разрешение на&nbsp;использование интернет-подключения. Делается это в&nbsp;настройках проекта</li>
		</ul>

		<p><img alt="" src="img/5.jpg" /></p>

		<p><strong>2.</strong>&nbsp;Начинаем с&nbsp;верстки MainPage. Она будет представлять собой простой<br />
		список&nbsp;&mdash; ListView. Здесь мы&nbsp;обрабатываем события нажатия, привязываем данные и&nbsp;делаем разметку</p>

		<p><img alt="" src="img/6.jpg" /></p>

		<p><strong>Важно</strong></p>

		<p>В&nbsp;свойство ListView установливаем параметр HasUnivenRows, который позволит иметь динамический размер объекта.</p>

		<p><strong>3.</strong>&nbsp;Давайте попробуем получить с&nbsp;помощью API список автомобилей и&nbsp;работать с&nbsp;ним</p>

		<ul>
			<li>Сначала тестируем запрос в&nbsp;браузере</li>
		</ul>

		<p><img alt="" src="img/7.jpg" /></p>

		<ul>
			<li>Полученный ответ мы&nbsp;можем скопировать</li>
		</ul>

		<p><img alt="" src="img/8.jpg" /></p>

		<ul>
			<li>Создаем новый класс Car в&nbsp;нашем проекте. И&nbsp;с&nbsp;помощью специальной вставки&nbsp;мы&nbsp;можем вставить скопированный текст в&nbsp;виде JSON-объектов</li>
		</ul>

		<p><img alt="" src="img/9.jpg" /></p>

		<p>Т. е. мы&nbsp;проанализировали полученный ответ и&nbsp;создаем в&nbsp;соответствии с&nbsp;этим&nbsp;свойство</p>

		<p><img alt="" src="img/10.jpg" /></p>

		<ul>
			<li>Также мы можем добавить свое свойство &mdash; оно нам пригодится для вывода изображения</li>
		</ul>

		<p><img alt="" src="img/11.jpg" /></p>

		<ul>
			<li>По аналогии создаем класс Reservation</li>
		</ul>

		<p><img alt="" src="img/12.jpg" /></p>
		
		<p><strong>4.&nbsp;</strong>На&nbsp;странице MainPage мы&nbsp;получаем список автомобилей с&nbsp;помощью класса WebClient, где указываем строку подключения, также, как это было в&nbsp;Android 10.0.2.2.</p>

		<p><img alt="" src="img/13.jpg" /></p>

		<p><strong>5.</strong>&nbsp;Результат возвращается нам в&nbsp;формате json, который мы&nbsp;будем обрабатывать. Удобнее всего использовать библиотеку Newtonsoft. Json, позволяющую конвертировать объекты в&nbsp;формат типа json и&nbsp;обратно. Эти процессы называются сериализацией и&nbsp;десериализацией соответственно.</p>

		<ul>
			<li>Для начала подключаем библиотеку Newtonsoft. Json в&nbsp;проекте</li>
		</ul>

		<p><img alt="" src="img/14.jpg" /></p>

		<ul>
			<li>Десериализуем ответ в&nbsp;список автомобилей&nbsp;и&nbsp;установливаем в&nbsp;качестве источника данных ListView. Не&nbsp;забудьте пересобрать проект, прежде чем это делать</li>
		</ul>

		<p><img alt="" src="img/15.jpg" /></p>

		<ul>
			<li>Запускаем созданный проект на&nbsp;эмуляторе. Список автомобилей&nbsp;выводится</li>
		</ul>

		<p><img alt="" src="img/16.jpg" /></p>

		<p><strong>6.</strong>&nbsp;Теперь создаем вторую страницу ReservationsPage для просмотра бронирований&nbsp;и&nbsp;добавления новых</p>

		<p><img alt="" src="img/17.jpg" /></p>

		<p><strong>7.</strong>&nbsp;Добавляем ListView для вывода бронирований</p>

		<ul>
			<li>указываем динамический размер элементов, привязку данных</li>
			<li>выполняем привязку содержимого</li>
		</ul>

		<p><img alt="" src="img/18.jpg" /></p>

		<p><strong>8.</strong>&nbsp;В&nbsp;качестве источника данных для привязки мы&nbsp;можем использовать объект любого публичного класса. В&nbsp;том числе и ReservationsPage</p>

		<ul>
			<li>Поработаем с&nbsp;конструктором новой страницы ReservationsPage, передавая в&nbsp;качестве параметра объект выбранного автомобиля. Cоздаем дополнительные свойства для биндинга</li>
		</ul>

		<p><img alt="" src="img/19.jpg" /></p>

		<ul>
			<li>Создаем метод для обновления списка бронирований,&nbsp;где получаем ответ с&nbsp;помощью запроса GetCarReservations, и&nbsp;десериализуем ответ. После этого загружаем полученный результат в&nbsp;список</li>
		</ul>

		<p><img alt="" src="img/20.jpg" /></p>

		<ul>
			<li>Вызываем метод updateReservations после отображения страницы</li>
		</ul>

		<p><img alt="" src="img/21.jpg" /></p>

		<ul>
			<li>Теперь создаем переход на&nbsp;эту страницу с&nbsp;главной. С&nbsp;помощью метода PushAsync мы&nbsp;будем передавать экземпляр выбранного автомобиля&nbsp;в&nbsp;списке</li>
		</ul>

		<p><img alt="" src="img/22.jpg" /></p>

		<ul>
			<li>Делаем остальные элементы управления для добавления бронирования. Сразу делаем привязку и&nbsp;обрабатываем клик по&nbsp;кнопке &laquo;отправить&raquo;</li>
		</ul>

		<p><img alt="" src="img/23.jpg" /></p>

		<ul>
			<li>Используем метод POST для загрузки бронирования. В&nbsp;нем мы&nbsp;будем использовать метод UploadString для загрузки данных и&nbsp;передавать туда тот объект, который мы&nbsp;создали. При этом его нужно будет сериализовать. Не&nbsp;забудьте указать ContentType у&nbsp;вашего запроса и&nbsp;после этого обновить бронирования</li>
		</ul>

		<p><img alt="" src="img/24.jpg" /></p>

		<p><strong>9.</strong>&nbsp;Запускаем и&nbsp;тестируем созданный функционал. Выбрав автомобиль, открываем бронирования, которые к&nbsp;нему относятся, и&nbsp;можем добавить свое</p>

		<h1>Итоги</h1>

		<p>Мы&nbsp;рассмотрели создание приложения Xamarin.Forms, освоили навигацию между страницами, поработали со&nbsp;списками, получая информацию с&nbsp;помощью GET запросов нашего API, а&nbsp;также протестировали работу POST запроса на&nbsp;примере добавления бронирования автомобиля.</p>

    </div>
</body>
</html>